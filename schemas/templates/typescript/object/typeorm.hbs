import { EntitySchema } from "typeorm"
import { {{ getType obj }} } from '{{ getImportPath obj }}'

export const {{ getType obj }}Entity = new EntitySchema<{{ getType obj }}>({
    name: '{{ lc (getType obj) }}',
    columns: {
        {{#each obj.properties}}
        {{#unless persistence.relation}}
        {{ @key }}: {
            type: '{{ lc (getType this) }}',
            {{#if persistence.primary }}primary: {{ persistence.primary }},{{/if}}
            {{#if persistence.generated }}generated: '{{ persistence.generated }}',{{/if}}
            {{#if maxLength }}length: {{ maxLength }},{{/if}}
            nullable: {{ propOptional ../obj @key }},
        },
        {{/unless}}
        {{/each}}
    }, 
    relations: {
        {{#each obj.properties}}
        {{#if persistence.relation }}
        {{ @key }}: {
            type: '{{ persistence.relation }}',
            target: '{{ lc (getType this) }}',
            {{#if persistence.eager }}eager: {{ persistence.eager }},{{/if}}
        },
        {{/if}}
        {{/each}}
    },
})
